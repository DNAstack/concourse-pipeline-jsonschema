{"$schema":"http://json-schema.org/draft-04/schema#","$ref":"#/definitions/Config","additionalProperties":true,"definitions":{"BuildLogRetention":{"properties":{"builds":{"type":"integer"},"minimum_succeeded_builds":{"type":"integer"},"days":{"type":"integer"}},"additionalProperties":false,"type":"object"},"CheckEvery":{"required":["Never","Interval"],"properties":{"Never":{"type":"boolean"},"Interval":{"type":"integer"}},"additionalProperties":false,"type":"integer"},"Config":{"properties":{"groups":{"items":{"$schema":"http://json-schema.org/draft-04/schema#","$ref":"#/definitions/GroupConfig"},"type":"array"},"var_sources":{"items":{"$schema":"http://json-schema.org/draft-04/schema#","$ref":"#/definitions/VarSourceConfig"},"type":"array"},"resources":{"items":{"$schema":"http://json-schema.org/draft-04/schema#","$ref":"#/definitions/ResourceConfig"},"type":"array"},"resource_types":{"items":{"$schema":"http://json-schema.org/draft-04/schema#","$ref":"#/definitions/ResourceType"},"type":"array"},"prototypes":{"items":{"$schema":"http://json-schema.org/draft-04/schema#","$ref":"#/definitions/Prototype"},"type":"array"},"jobs":{"items":{"$schema":"http://json-schema.org/draft-04/schema#","$ref":"#/definitions/JobConfig"},"type":"array"},"display":{"$schema":"http://json-schema.org/draft-04/schema#","$ref":"#/definitions/DisplayConfig"}},"additionalProperties":false,"type":"object"},"ContainerLimits":{"properties":{"cpu":{"type":"integer"},"memory":{"type":"integer"}},"additionalProperties":false,"type":"object"},"DisplayConfig":{"properties":{"background_image":{"type":"string"}},"additionalProperties":false,"type":"object"},"DoStep":{"required":["do"],"properties":{"do":{"items":{"$schema":"http://json-schema.org/draft-04/schema#","$ref":"#/definitions/Step"},"type":"array"}},"additionalProperties":false,"type":"object"},"GetStep":{"required":["get"],"properties":{"get":{"type":"string"},"resource":{"type":"string"},"version":{"$schema":"http://json-schema.org/draft-04/schema#","$ref":"#/definitions/VersionConfig"},"params":{"patternProperties":{".*":{"additionalProperties":true}},"type":"object"},"passed":{"items":{"type":"string"},"type":"array"},"trigger":{"type":"boolean"},"tags":{"items":{"type":"string"},"type":"array"},"timeout":{"type":"string"}},"additionalProperties":false,"type":"object"},"GroupConfig":{"required":["name"],"properties":{"name":{"type":"string"},"jobs":{"items":{"type":"string"},"type":"array"},"resources":{"items":{"type":"string"},"type":"array"}},"additionalProperties":false,"type":"object"},"ImageResource":{"required":["name","type","source"],"properties":{"name":{"type":"string"},"type":{"type":"string"},"source":{"patternProperties":{".*":{"additionalProperties":true}},"type":"object"},"version":{"patternProperties":{".*":{"type":"string"}},"type":"object"},"params":{"patternProperties":{".*":{"additionalProperties":true}},"type":"object"},"tags":{"items":{"type":"string"},"type":"array"}},"additionalProperties":false,"type":"object"},"InParallelConfig":{"properties":{"steps":{"items":{"$schema":"http://json-schema.org/draft-04/schema#","$ref":"#/definitions/Step"},"type":"array"},"limit":{"type":"integer"},"fail_fast":{"type":"boolean"}},"additionalProperties":false,"type":"object"},"InParallelStep":{"required":["in_parallel"],"properties":{"in_parallel":{"$schema":"http://json-schema.org/draft-04/schema#","$ref":"#/definitions/InParallelConfig"}},"additionalProperties":false,"type":"object"},"InputsConfig":{"required":["All","Detect","Specified"],"properties":{"All":{"type":"boolean"},"Detect":{"type":"boolean"},"Specified":{"items":{"type":"string"},"type":"array"}},"additionalProperties":false,"type":"object"},"JobConfig":{"required":["name","plan"],"properties":{"name":{"type":"string"},"old_name":{"type":"string"},"public":{"type":"boolean"},"disable_manual_trigger":{"type":"boolean"},"serial":{"type":"boolean"},"interruptible":{"type":"boolean"},"serial_groups":{"items":{"type":"string"},"type":"array"},"max_in_flight":{"type":"integer"},"build_logs_to_retain":{"type":"integer"},"build_log_retention":{"$schema":"http://json-schema.org/draft-04/schema#","$ref":"#/definitions/BuildLogRetention"},"on_success":{"$schema":"http://json-schema.org/draft-04/schema#","$ref":"#/definitions/Step"},"on_failure":{"$ref":"#/definitions/Step"},"on_abort":{"$ref":"#/definitions/Step"},"on_error":{"$ref":"#/definitions/Step"},"ensure":{"$ref":"#/definitions/Step"},"plan":{"items":{"$ref":"#/definitions/Step"},"type":"array"}},"additionalProperties":false,"type":"object"},"LoadVarStep":{"required":["load_var"],"properties":{"load_var":{"type":"string"},"file":{"type":"string"},"format":{"type":"string"},"reveal":{"type":"boolean"}},"additionalProperties":false,"type":"object"},"Prototype":{"required":["name","type","source"],"properties":{"name":{"type":"string"},"type":{"type":"string"},"source":{"patternProperties":{".*":{"additionalProperties":true}},"type":"object"},"defaults":{"patternProperties":{".*":{"additionalProperties":true}},"type":"object"},"privileged":{"type":"boolean"},"check_every":{"$ref":"#/definitions/CheckEvery"},"tags":{"items":{"type":"string"},"type":"array"},"params":{"patternProperties":{".*":{"additionalProperties":true}},"type":"object"}},"additionalProperties":false,"type":"object"},"PutStep":{"required":["put"],"properties":{"put":{"type":"string"},"resource":{"type":"string"},"params":{"patternProperties":{".*":{"additionalProperties":true}},"type":"object"},"inputs":{"$schema":"http://json-schema.org/draft-04/schema#","$ref":"#/definitions/InputsConfig"},"tags":{"items":{"type":"string"},"type":"array"},"get_params":{"patternProperties":{".*":{"additionalProperties":true}},"type":"object"},"timeout":{"type":"string"}},"additionalProperties":false,"type":"object"},"ResourceConfig":{"required":["name","type","source"],"properties":{"name":{"type":"string"},"old_name":{"type":"string"},"public":{"type":"boolean"},"webhook_token":{"type":"string"},"type":{"type":"string"},"source":{"patternProperties":{".*":{"additionalProperties":true}},"type":"object"},"check_every":{"$schema":"http://json-schema.org/draft-04/schema#","$ref":"#/definitions/CheckEvery"},"check_timeout":{"type":"string"},"tags":{"items":{"type":"string"},"type":"array"},"version":{"patternProperties":{".*":{"type":"string"}},"type":"object"},"icon":{"type":"string"},"expose_build_created_by":{"type":"boolean"}},"additionalProperties":false,"type":"object"},"ResourceType":{"required":["name","type","source"],"properties":{"name":{"type":"string"},"type":{"type":"string"},"source":{"patternProperties":{".*":{"additionalProperties":true}},"type":"object"},"defaults":{"patternProperties":{".*":{"additionalProperties":true}},"type":"object"},"privileged":{"type":"boolean"},"check_every":{"$ref":"#/definitions/CheckEvery"},"tags":{"items":{"type":"string"},"type":"array"},"params":{"patternProperties":{".*":{"additionalProperties":true}},"type":"object"}},"additionalProperties":false,"type":"object"},"SetPipelineStep":{"required":["set_pipeline"],"properties":{"set_pipeline":{"type":"string"},"file":{"type":"string"},"team":{"type":"string"},"vars":{"patternProperties":{".*":{"additionalProperties":true}},"type":"object"},"var_files":{"items":{"type":"string"},"type":"array"},"instance_vars":{"patternProperties":{".*":{"additionalProperties":true}},"type":"object"}},"additionalProperties":false,"type":"object"},"Step":{"anyOf":[{"$schema":"http://json-schema.org/draft-04/schema#","$ref":"#/definitions/GetStep"},{"$schema":"http://json-schema.org/draft-04/schema#","$ref":"#/definitions/PutStep"},{"$schema":"http://json-schema.org/draft-04/schema#","$ref":"#/definitions/TaskStep"},{"$schema":"http://json-schema.org/draft-04/schema#","$ref":"#/definitions/SetPipelineStep"},{"$schema":"http://json-schema.org/draft-04/schema#","$ref":"#/definitions/LoadVarStep"},{"$schema":"http://json-schema.org/draft-04/schema#","$ref":"#/definitions/InParallelStep"},{"$schema":"http://json-schema.org/draft-04/schema#","$ref":"#/definitions/DoStep"},{"$schema":"http://json-schema.org/draft-04/schema#","$ref":"#/definitions/TryStep"}]},"TaskCacheConfig":{"properties":{"path":{"type":"string"}},"additionalProperties":false,"type":"object"},"TaskConfig":{"properties":{"platform":{"type":"string"},"rootfs_uri":{"type":"string"},"image_resource":{"$schema":"http://json-schema.org/draft-04/schema#","$ref":"#/definitions/ImageResource"},"container_limits":{"$ref":"#/definitions/ContainerLimits"},"params":{"patternProperties":{".*":{"type":"string"}},"type":"object"},"run":{"$schema":"http://json-schema.org/draft-04/schema#","$ref":"#/definitions/TaskRunConfig"},"inputs":{"items":{"$schema":"http://json-schema.org/draft-04/schema#","$ref":"#/definitions/TaskInputConfig"},"type":"array"},"outputs":{"items":{"$schema":"http://json-schema.org/draft-04/schema#","$ref":"#/definitions/TaskOutputConfig"},"type":"array"},"caches":{"items":{"$schema":"http://json-schema.org/draft-04/schema#","$ref":"#/definitions/TaskCacheConfig"},"type":"array"}},"additionalProperties":false,"type":"object"},"TaskInputConfig":{"required":["name"],"properties":{"name":{"type":"string"},"path":{"type":"string"},"optional":{"type":"boolean"}},"additionalProperties":false,"type":"object"},"TaskOutputConfig":{"required":["name"],"properties":{"name":{"type":"string"},"path":{"type":"string"}},"additionalProperties":false,"type":"object"},"TaskRunConfig":{"required":["path"],"properties":{"path":{"type":"string"},"args":{"items":{"type":"string"},"type":"array"},"dir":{"type":"string"},"user":{"type":"string"}},"additionalProperties":false,"type":"object"},"TaskStep":{"required":["task"],"properties":{"task":{"type":"string"},"privileged":{"type":"boolean"},"file":{"type":"string"},"container_limits":{"$schema":"http://json-schema.org/draft-04/schema#","$ref":"#/definitions/ContainerLimits"},"config":{"$schema":"http://json-schema.org/draft-04/schema#","$ref":"#/definitions/TaskConfig"},"params":{"patternProperties":{".*":{"type":"string"}},"type":"object"},"vars":{"patternProperties":{".*":{"additionalProperties":true}},"type":"object"},"tags":{"items":{"type":"string"},"type":"array"},"input_mapping":{"patternProperties":{".*":{"type":"string"}},"type":"object"},"output_mapping":{"patternProperties":{".*":{"type":"string"}},"type":"object"},"image":{"type":"string"},"timeout":{"type":"string"}},"additionalProperties":false,"type":"object"},"TryStep":{"required":["try"],"properties":{"try":{"$schema":"http://json-schema.org/draft-04/schema#","$ref":"#/definitions/Step"}},"additionalProperties":false,"type":"object"},"VarSourceConfig":{"required":["name","type","config"],"properties":{"name":{"type":"string"},"type":{"type":"string"},"config":{"additionalProperties":true}},"additionalProperties":false,"type":"object"},"VersionConfig":{"required":["Every","Latest","Pinned"],"properties":{"Every":{"type":"boolean"},"Latest":{"type":"boolean"},"Pinned":{"patternProperties":{".*":{"type":"string"}},"type":"object"}},"additionalProperties":false,"type":"object"}}}
